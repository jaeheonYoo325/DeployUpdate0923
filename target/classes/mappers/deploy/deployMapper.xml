<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="DeployDao">
	<insert id="insertOneDeployDao" parameterType="DeployDto">
      INSERT INTO DEPLOY (
                         d_chainId
                        , wtype
                        , reqDate
                        , reqTime
                        , reqserviceId
                        , wEmpNo
                        , wContent
                        , reqEmpNo
                        , deployEmpNo
                        , devEmpNo
                        , testEmpNo
                        , prdEmpNo
                        , division
                        
                     )
      VALUES            (
                         #{d_chainId}
                        , #{wtype}
                        , #{reqDate}
                        , #{reqTime}
                        , #{reqServiceId}
                        , #{wEmpNo}
                        , #{wContent}
                        , #{reqEmpNo}
                        , #{deployEmpNo}
                        , #{devEmpNo}
                        , #{testEmpNo}
                        , #{prdEmpNo}
                        , #{division}
                     )   
   </insert>
   
   
   <insert id="insertOneDeploy2" parameterType="java.util.ArrayList">
   INSERT INTO WPROGRAMTABLE(wProNo_pageId,wProNo_deployNo)
   VALUES
   <foreach collection="list" item="item" index="index">
   (#{item.value)
   </foreach>
                           
   
                        
   </insert>
	
	<select id="selectAllDeployDao" resultType="DeployDto">
		SELECT 
	         d.deployNo
	         , c.chainName
	         , d.d_chainId
	         , d.wtype
	         , d.reqDate
	         , d.reqTime
	         , d.reqServiceId
	         , d.wContent
	         , d.reqEmpNo
	         , d.wEmpNo
	         , d.deployEmpNo
	         , d.devEmpNo
	         , d.testEmpNo
	         , d.prdEmpNo
	         , d.division  
		 FROM deploy d 
		 JOIN CHAINTABLE c
		 ON(d.d_chainID=c.chainID)
	</select>
	
	<select id="selectAllWProgramDao" resultType="WProgramTableDto" parameterType="_int" >
	SELECT
	       wProNo_pageId
	      ,wProNo_pageName
	      ,wProNo_deployNo
	FROM WPROGRAMTABLE
	WHERE wProNo_deployNo=#{deployNo}
	</select>
	
	<select id="selectAllWSourceDao" resultType="WSourceTableDto" parameterType="_int">
	SELECT
	      wSo_deployNo
	     ,wSo_wSourceName
	FROM WSOURCETABLE
	WHERE wSo_deployNo=#{deployNo}
	</select>
	
	<select id="selectAllStatusDao" resultType="StatusTableDto" parameterType="_int">
	SELECT
	      st_deployNo
	     ,st_status
	FROM STATUSTABLE
	WHERE st_deployNo=#{deployNo}
	</select>
	
	<select id="selectOneDeployDao" parameterType="_int" resultType="DeployDto">
		SELECT 
	         d.deployNo
	         , d.d_chainId
	         , d.wtype
	         , d.reqDate
	         , d.reqTime
	         , d.reqServiceId
	         , d.wEmpNo
	         , d.wContent
	         , d.reqEmpNo
	         , d.deployEmpNo
	         , d.devEmpNo
	         , d.testEmpNo
	         , d.prdEmpNo
	         , d.division
	         , c.chainName
		 FROM deploy d 
		 JOIN CHAINTABLE c
		 ON (d.d_chainId=c.chainID)
		 WHERE d.deployNo=#{deployNo}
	</select>
	
	<update id="updateOneDeployDao" parameterType="DeployDto">
	  UPDATE    DEPLOY
      SET   
              d_chainId = #{d_chainId}       
            , wtype  = #{wtype}     
            , reqDate = #{reqDate}    
            , reqTime = #{reqTime}    
            , reqServiceId = #{reqServiceId}
            , wEmpNo = #{wEmpNo}
            , wContent = #{wContent}    
            , reqempNo = #{reqEmpNo}  
            , deployempNo = #{deployEmpNo}
            , devempNo = #{devEmpNo}  
            , testempNo = #{testEmpNo} 
            , prdempNo = #{prdEmpNo}  
            , division = #{division}
      WHERE   deployNo = #{deployNo}
	</update>
	
	<delete id="deleteOneDeployDao" parameterType="_int">
		DELETE
		FROM	DEPLOY
		WHERE	deployNo = #{deployNo}
	</delete>

	<select id="selectSomeDeployDao" parameterType="EmployeeDto" resultType="EmployeeDto">
      SELECT
            empNo
           , empName
      FROM EMPLOYEE
      WHERE empName=#{empName}
   </select>
   <select id="selectSomeChainDao" parameterType="ChainTableDto" resultType="ChainTableDto">
      SELECT
           chainId
          ,chainName
       FROM CHAINTABLE
       WHERE chainName LIKE CONCAT('%',#{chainName},'%')
   </select>      
   
   <select id="selectSomeProgramDao" parameterType="ProgramTableDto" resultType="ProgramTableDto">
      SELECT
            pageId
           , pageName
           , p_chainId
       FROM  PROGRAMTABLE
       WHERE pageName LIKE CONCAT('%',#{pageName},'%')
       AND p_chainId=#{paramChainId}
   </select>   
   
   <select id="selectAllChainDao" resultType="ChainTableDto">
   SELECT
   		 chainId
   	   , chainName
   FROM CHAINTABLE
   </select> 
   
   <select id="selectAllProgramDao" parameterType="ProgramTableDto" resultType="ProgramTableDto">
   SELECT
          pageId
         ,pageName
         ,p_chainId
   FROM  PROGRAMTABLE      
   WHERE p_chainId=#{paramChainId}
   </select>  
   
   <select id="selectMaxDeployNo" resultType="_int">
   SELECT
         MAX(deployNo)
   FROM DEPLOY
   </select>
   
   <insert id="insertOneWProgram" parameterType="WProgramTableDto">
  	 INSERT INTO WPROGRAMTABLE      (
                                 wProNo_pageId
                                 , wProNo_deployNo
                                 , wProNo_pageName
                              ) 
  	 VALUES
                              (
                                 #{wProNo_pageId}
                                 ,#{wProNo_deployNo}
                                 ,#{wProNo_pageName}
                              )
   </insert>
   
   <insert id="insertOneWSource" parameterType="WSourceTableDto">
   	INSERT INTO WSOURCETABLE         (
                                 wSo_deployNo
                                 , wSo_wSourceName
                              ) 
   	VALUES
                              (
                                 #{wSo_deployNo}
                                 ,#{wSo_wSourceName}
                              )
   </insert>
   
   <insert id="insertOneStatus" parameterType="StatusTableDto">
   	INSERT INTO STATUSTABLE          (
                                 st_deployNo
                                 , st_status
                              )
   	VALUES
                              (
                                 #{st_deployNo}
                                 ,#{st_status}
                              )
   </insert>
   
   <delete id="deleteAllWProgram" parameterType="_int">
   DELETE FROM WPROGRAMTABLE
   WHERE wProNo_deployNo=#{deployNo}
   </delete>
   
   <delete id="deleteAllWSource" parameterType="_int">
   DELETE FROM WSOURCETABLE
   WHERE wSo_deployNo=#{deployNo}
   </delete>
   
   <delete id="deleteAllStatus" parameterType="_int">
   DELETE FROM STATUSTABLE
   WHERE st_deployNo=#{deployNo}
   </delete>
</mapper>                         
                                  
